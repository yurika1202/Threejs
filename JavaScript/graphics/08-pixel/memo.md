## 同一生成ポリシー

- Canvas でピクセル操作を行う時、同一生成ポリシーに抵触すると想定のプログラム実行がされない場合がある
- 同一生成ポリシーとは、オリジンという「範囲の定義」をつくり同じオリジンに含まれるかどうかを基準にアクセス制限を行うもの
- ここではスキーム、ホスト、ポートの 3 つの要素を組み合わせたもの`http://sample.com:8000`＝`スキーム // ホスト :ポート`
- 例えば「画像を読み込み Canvas 上で描画する」ことには制限はかからないが、「画像を読み込み Canvas 上で描画し、そのピクセルを操作する」場合は同一生成ポリシーによって制限がかかる
- 制限回避するには「同じオリジンに属するファイルを利用している」と判断する環境を整える

## ImageDate オブジェクト

- ピクセル単位で操作するときに窓口となってくれるオブジェクト
- 単体でインスタンス化も可能だが、CanvasAPI とセットで使うのが一般的

## TypedArray

- ImageDate オブジェクトのプロパティのひとつである date にあるオブジェクト
- Unit8Array（配列の要素 1 つあたりに 8 ビット符号なし整数がひとつはいることを表す）などがあり、配列の各要素が厳格な型の概念を持っている
- 色情報の格納順序が左から右へ向かい、右端まで到達したら次段の左端へ移る（Z のような感じ）＝ 1 次元の配列
- 情報書き換え時には、putImageDate メソッドを使用する

## グレースケール

- RGB 値を平均化して実装すると、(255, 0, 0)も(0, 0, 255)も同じ結果になる＝人間の視覚とは異なった結果になってしまう
- NTSC 加重平均法を使うと、人間の目の性質を考慮した計算が可能
- チャネル毎の係数は国際電気通信連合の規格に規定されている数値に基づいて、あらかじめ決められている定数

```
let r = data[index] * 0.298912;
let g = data[index + 1] * 0.586611;
let b = data[index + 2] * 0.114478;
let luminance = r + g + b;
```
